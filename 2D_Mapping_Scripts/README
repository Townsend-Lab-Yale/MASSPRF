# MASS-PRF Output Processing and Visualization Script

This script processes output files from MASS-PRF, classifies selection coefficients, and generates 2D visualizations of selection pressures across nucleotide positions.

## Features
### 1. Input File Processing
   - Reads `.txt` files generated by MASS-PRF.
   - Checks if the analysis completed successfully and extracts relevant data.

### 2. Classification
   - Classifies genes based on selection coefficients (`Gamma`) into:
     - **Positive selection**
     - **Strongly positive selection**
     - **Negative selection**
     - **No significant selection ("boring genes")**
     - **Failed runs**

### 3. Output
   - Saves processed results as `.csv` files.
   - Generates lists of significant sites (`.txt` files) for each category.

### 4. Visualization
   - Creates **2D plots** of selection coefficients (`Gamma`) against nucleotide positions.
   - Visualizes **confidence intervals** for `Gamma` values.
   - Saves plots as `.pdf` files in `./processed_output/plots/`.

## File Structure
- **Input**: `.txt` files in the working directory.
- **Output**:
  - Processed results in `./processed_output/`
  - 2D plots in `./processed_output/plots/`

## Requirements
- **Python 3**
- **Required libraries**:
  ```python
  os
  re
  pandas
  matplotlib
  numpy
## Usage

Place your MASS-PRF output `.txt` files in the script's working directory.

Run the script:

```bash
python3 script_name.py

Processed results and plots will be saved in the ./processed_output/ directory.

## Acknowledgment
We would like to thank Dr. Hayley Hassler for her contribution in developing the foundational 2D visualization scripts that inspired this tool. Her work laid the groundwork for automating the processing and visualization of MASS-PRF results.


